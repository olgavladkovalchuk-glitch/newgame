<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>–ü—è—Ç–∏–ª–µ—Ç–∫–∞ –£—Å–ø–µ—Ö–∞: –ù–ò–ò –ü–†–ê–ó–î–ù–ò–ö</title>

    <!-- React –∏ Babel -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- –®—Ä–∏—Ñ—Ç—ã -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Courier+Prime:ital,wght@0,400;0,700;1,400&family=Russo+One&display=swap" rel="stylesheet">

    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              'soviet-black': '#1a1a1a',
              'soviet-beige': '#fdfbf7',
            },
            fontFamily: {
              mono: ['"Courier Prime"', 'monospace'],
              display: ['"Russo One"', 'sans-serif'],
            },
            keyframes: {
              'pop-in': {
                '0%': { transform: 'scale(0.9)', opacity: '0' },
                '100%': { transform: 'scale(1)', opacity: '1' },
              },
              'stamp-slam': {
                '0%': { transform: 'scale(4) rotate(-20deg)', opacity: '0' },
                '100%': { transform: 'scale(1) rotate(-8deg)', opacity: '0.9' },
              },
              'noise': {
                '0%, 100%': { backgroundPosition: '0 0' },
                '50%': { backgroundPosition: '-10% 5%' },
              },
              'jiggle': {
                '0%, 100%': { transform: 'scale(1) rotate(0deg)' },
                '25%': { transform: 'scale(1.1) rotate(-3deg)' },
                '50%': { transform: 'scale(1.05) rotate(3deg)' },
                '75%': { transform: 'scale(1.1) rotate(-1deg)' },
              }
            },
            animation: {
              'pop-in': 'pop-in 0.3s ease-out forwards',
              'stamp-slam': 'stamp-slam 0.15s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards',
              'noise': 'noise 0.1s steps(1) infinite',
              'float': 'float 3s ease-in-out infinite',
              'jiggle': 'jiggle 0.2s ease-in-out',
            }
          }
        }
      }
    </script>

    <style>
      @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
      }
      body {
        background-color: #eaddcf;
        color: #1a1a1a;
        overflow: hidden;
        touch-action: manipulation;
      }
      .paper-texture {
        background-image: url('https://www.transparenttextures.com/patterns/aged-paper.png');
      }
      .custom-scrollbar::-webkit-scrollbar { width: 6px; }
      .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
      .custom-scrollbar::-webkit-scrollbar-thumb { background: #1a1a1a33; border-radius: 10px; }
      .brutalist-shadow { box-shadow: 4px 4px 0px 0px #1a1a1a; }
      .brutalist-shadow-sm { box-shadow: 2px 2px 0px 0px #1a1a1a; }
      .collage-cut { clip-path: polygon(0.5% 0.5%, 99.5% 0%, 100% 99.5%, 0% 100%); }
      * { -webkit-tap-highlight-color: transparent; }
      .terminal-scanline {
        background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
        background-size: 100% 2px, 3px 100%;
        pointer-events: none;
      }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        // ========== –ò–ö–û–ù–ö–ò (–ò–°–ü–†–ê–í–õ–ï–ù–û) ==========
        const Icon = ({ name, size = 24, className = "" }) => {
            const props = { width: size, height: size, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: 2, strokeLinecap: "round", strokeLinejoin: "round", className };

            switch(name) {
                case 'Zap': return <svg {...props}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>;
                case 'Gift': return <svg {...props}><polyline points="20 12 20 22 4 22 4 12"></polyline><rect x="2" y="7" width="20" height="5"></rect><line x1="12" y1="22" x2="12" y2="7"></line><path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"></path><path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"></path></svg>;
                case 'Skull': return <svg {...props}><circle cx="9" cy="12" r="1"></circle><circle cx="15" cy="12" r="1"></circle><path d="M8 20v2h8v-2"></path><path d="M12.5 17l-.5-4"></path><path d="M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20"></path></svg>;
                case 'Terminal': return <svg {...props}><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>;
                case 'Loader2': return <svg {...props}><line x1="12" y1="2" x2="12" y2="6"></line><line x1="12" y1="18" x2="12" y2="22"></line><line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line><line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line><line x1="2" y1="12" x2="6" y2="12"></line><line x1="18" y1="12" x2="22" y2="12"></line><line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line><line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line></svg>;
                case 'FileText': return <svg {...props}><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>;
                case 'Send': return <svg {...props}><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>;
                case 'Pin': return <svg {...props}><line x1="12" y1="17" x2="12" y2="22"></line><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"></path></svg>;
                case 'Coffee': return <svg {...props}><path d="M18 8h1a4 4 0 0 1 0 8h-1"></path><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"></path><line x1="6" y1="1" x2="6" y2="4"></line><line x1="10" y1="1" x2="10" y2="4"></line><line x1="14" y1="1" x2="14" y2="4"></line></svg>;
                case 'CheckCircle2': return <svg {...props}><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"></path><path d="m9 12 2 2 4-4"></path></svg>;
                case 'ShieldAlert': return <svg {...props}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path><path d="M12 8v4"></path><path d="M12 16h.01"></path></svg>;
                case 'AlertTriangle': return <svg {...props}><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>;
                case 'TrendingUp': return <svg {...props}><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>;
                case 'TrendingDown': return <svg {...props}><polyline points="23 18 13.5 8.5 8.5 13.5 1 6"></polyline><polyline points="17 18 23 18 23 12"></polyline></svg>;
                default: return <svg {...props}><circle cx="12" cy="12" r="10"></circle></svg>;
            }
        };

        // ========== –ö–û–ù–°–¢–ê–ù–¢–´ ==========
        const ASSETS = {
          DED_MOROZ: "https://i.imgur.com/BBZGnJR.png",
          SNEGURKA: "https://i.imgur.com/HeILuSu.png",
          LIHODEEV: "https://i.imgur.com/mbTjHq0.png",
          KHOLODETS: "https://i.ibb.co/27yLBkhN/photo-2025-12-19-14-56-49-Photoroom.png"
        };

        const NII_SLOGANS = [
          "–ü–†–ê–ó–î–ù–ò–ö ‚Äî –≠–¢–û –ü–†–ò–ö–ê–ó. –í–´–ü–û–õ–ù–Ø–ô–¢–ï!",
          "–ö–¢–û –ù–ï –ï–°–¢ –û–õ–ò–í–¨–ï, –¢–û–¢ –°–ê–ë–û–¢–ê–ñ–ù–ò–ö!",
          "–ú–ê–ù–î–ê–†–ò–ù: –í–ò–¢–ê–ú–ò–ù–ù–´–ô –ó–ê–†–Ø–î –ü–û–ë–ï–î–´!",
          "–¢–û–í–ê–†–ò–©, –¢–í–û–ô –°–ú–ï–• ‚Äî –£–î–ê–† –ü–û –í–†–ê–ì–ê–ú!",
          "–°–ò–ú–£–õ–Ø–¶–ò–Ø –†–ê–î–û–°–¢–ò ‚Äî –ü–£–¢–¨ –ö –£–°–ü–ï–•–£!",
          "–ù–ò–ò –ü–†–ê–ó–î–ù–ò–ö: –ß–£–î–ï–°–ê –°–¢–†–û–ì–û –ü–û –ì–†–ê–§–ò–ö–£!"
        ];

        const CHARACTERS = {
          director: { id: 'director', name: '–ê–∫–∞–¥–µ–º–∏–∫ –ú–æ—Ä–æ–∑', role: '–°–Ω–µ–∂–Ω—ã–π –ú–∞—Ä—à–∞–ª', avatarImageSrc: ASSETS.DED_MOROZ, color: 'bg-red-950' },
          sneg: { id: 'sneg', name: '–°–Ω–µ–≥—É—Ä–∫–∞-1.0', role: '–ö–∏–±–µ—Ä-–°–Ω–µ–∂–∏–Ω–∫–∞', avatarImageSrc: ASSETS.SNEGURKA, color: 'bg-cyan-950' },
          lihodeev: { id: 'lihodeev', name: '–õ–∏—Ö–æ–¥–µ–µ–≤ –ü.–ü.', role: '–í–∞—Ö—Ç–µ—Ä-—ç–∫–∑–æ—Ä—Ü–∏—Å—Ç', avatarImageSrc: ASSETS.LIHODEEV, color: 'bg-slate-950' }
        };

        const SCENARIOS = [
          {
            id: 1, characterId: 'director', title: "–î–ò–†–ï–ö–¢–ò–í–ê '–¶–ò–¢–†–£–°'",
            description: "–ú–∞–Ω–¥–∞—Ä–∏–Ω—ã –≤ —ç—Ç–æ–º –≥–æ–¥—É —Å–ª–∏—à–∫–æ–º –∫–∏—Å–ª—ã–µ. –ù–∞—Ä–æ–¥ –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å –¥—É–º–∞—Ç—å –æ –ø–æ–ª–∏—Ç–∏–∫–µ –≤–º–µ—Å—Ç–æ –ø—Ä–∞–∑–¥–Ω–∏–∫–∞. –°—Ä–æ—á–Ω–æ –ø—Ä–∏–º–∏—Ç–µ –º–µ—Ä—ã!",
            dialogue: "–õ–∞–±–æ—Ä–∞–Ω—Ç! –£ –Ω–∞—Å –ß–ü. –ö—Ä–∞—Å–∏–º –º–∞–Ω–¥–∞—Ä–∏–Ω—ã –≤ –∑–æ–ª–æ—Ç–æ–π —Ü–≤–µ—Ç –∏–ª–∏ –≤–∫–∞–ª—ã–≤–∞–µ–º —Å–∞—Ö–∞—Ä–Ω—ã–π —Å–∏—Ä–æ–ø?",
            leftChoice: { text: "–ó–æ–ª–æ—Ç–∞—è –∫—Ä–∞—Å–∫–∞", effect: { resonance: 30, quota: -10 }, feedback: "–ù–∞—Ä–æ–¥ –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ –æ—Ç –±–ª–µ—Å–∫–∞! –ü—Ä–µ—Å—Ç–∏–∂ –≤—ã—Ä–æ—Å, –Ω–æ –≤–∏—Ç–∞–º–∏–Ω–æ–≤ –≤ –∫—Ä–∞—Å–∫–µ –Ω–µ—Ç.", feedbackTitle: "–ó–û–õ–û–¢–û–ô –°–¢–ê–ù–î–ê–†–¢" },
            rightChoice: { text: "–ò–Ω—ä–µ–∫—Ü–∏—è —Å–∏—Ä–æ–ø–∞", effect: { resonance: -10, quota: 40 }, feedback: "–ú–∞–Ω–¥–∞—Ä–∏–Ω—ã —Å–ª–∞–¥–∫–∏–µ, –Ω–æ –ª–∏–ø–∫–∏–µ. –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω, –Ω–æ –≥—Ä–∞–∂–¥–∞–Ω–µ –ø—Ä–∏–ª–∏–ø–ª–∏ –∫ –º–µ–±–µ–ª–∏.", feedbackTitle: "–õ–ò–ü–ö–ò–ô –£–°–ü–ï–•" }
          },
          {
            id: 2, characterId: 'sneg', title: "–ö–í–ê–ù–¢–û–í–´–ô –°–ù–ï–ì",
            description: "–°–Ω–µ–≥–æ–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤—ã–¥–∞–µ—Ç –≤–º–µ—Å—Ç–æ —Å–Ω–µ–≥–∞ –ø–æ–ø–∫–æ—Ä–Ω. –õ—ã–∂–Ω–∏–∫–∏ –∑–ª—ã, –¥–µ—Ç–∏ –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ. –ß—Ç–æ –¥–µ–ª–∞—Ç—å?",
            dialogue: "–û—à–∏–±–∫–∞... –ø–æ–ø–∫–æ—Ä–Ω... —Å–æ–ª–µ–Ω—ã–π... –ß–∏–Ω–∏–º —Å–∏—Å—Ç–µ–º—É —Å–∏–ª–æ–π –∏–ª–∏ –æ–±—ä—è–≤–∏–º —ç—Ç–æ —Ä–µ—Ñ–æ—Ä–º–æ–π?",
            leftChoice: { text: "–ß–ò–ù–ò–¢–¨ –ö–£–í–ê–õ–î–û–ô", effect: { resonance: -20, quota: 25 }, feedback: "–û—Ç —É–¥–∞—Ä–∞ –ø–æ—à–µ–ª —Å–Ω–µ–≥ –∏–∑ —Ç–µ—Ä—Ç–æ–π –º–æ—Ä–∫–æ–≤–∏. –ù–µ–æ–±—ã—á–Ω–æ, –Ω–æ –ø–æ –ì–û–°–¢—É.", feedbackTitle: "–°–£–†–û–í–´–ô –†–ï–ú–û–ù–¢" },
            rightChoice: { text: "–†–ï–§–û–†–ú–ê", effect: { resonance: 40, quota: -15 }, feedback: "–ü–æ–ø–∫–æ—Ä–Ω ‚Äî —ç—Ç–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–Ω–µ–≥. –í–µ—Å—å –≥–æ—Ä–æ–¥ —Ö—Ä—É—Å—Ç–∏—Ç —Å—É–≥—Ä–æ–±–∞–º–∏. –†–∞–¥–æ—Å—Ç—å!", feedbackTitle: "–ò–ù–ù–û–í–ê–¶–ò–Ø" }
          },
          {
            id: 3, characterId: 'lihodeev', title: "–ñ–ï–õ–ï–ô–ù–´–ô –ë–£–ù–¢",
            description: "–•–æ–ª–æ–¥–µ—Ü –≤ —Å—Ç–æ–ª–æ–≤–æ–π –æ–±—Ä–µ–ª —Ä–∞–∑—É–º –∏ –∑–∞–±–∞—Ä—Ä–∏–∫–∞–¥–∏—Ä–æ–≤–∞–ª –∞—Ä—Ö–∏–≤. –û–Ω —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤–∞ –≥–æ–ª–æ—Å–∞!",
            dialogue: "–≠—Ç–∞ —Ç—Ä—è—Å—É—â–∞—è—Å—è –º—Ä–∞–∑—å –ø–æ–≥–ª–æ—Ç–∏–ª–∞ –ø–æ–≤–∞—Ä–∞! –õ–∏–∫–≤–∏–¥–∏—Ä—É–µ–º –≤ –±–æ—é –∏–ª–∏ –¥–∞–¥–∏–º –¥–∏–ø–ª–æ–º?",
            leftChoice: { text: "–õ–ò–ö–í–ò–î–ê–¶–ò–Ø (–ë–û–ô)", effect: { resonance: 15, quota: 15 }, feedback: "–•–≤–∞—Ç–∞–π –ª–æ–∂–∫—É! –≠—Ç–∞ –±–∏—Ç–≤–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –±—É–¥—É—â–µ–µ –Ω–∞—à–µ–π —Å—Ç–æ–ª–æ–≤–æ–π. –í –±–æ–π!", feedbackTitle: "–ö –°–†–ê–ñ–ï–ù–ò–Æ!" },
            rightChoice: { text: "–î–ò–ü–õ–û–ú –§–ò–õ–û–°–û–§–ê", effect: { resonance: -30, quota: 35 }, feedback: "–•–æ–ª–æ–¥–µ—Ü —Ç–µ–ø–µ—Ä—å –≤ –∞—Ä—Ö–∏–≤–µ. –û–Ω –Ω–∞—Å—Ç–æ–ª—å–∫–æ –Ω—É–¥–Ω—ã–π, —á—Ç–æ –ø—Ä–∏–∑—Ä–∞–∫–∏ —É–≤–æ–ª–∏–ª–∏—Å—å.", feedbackTitle: "–£–ú–ò–†–û–¢–í–û–†–ï–ù–ò–ï" }
          },
          {
            id: 4, characterId: 'director', title: "–°–¢–ê–ù–î–ê–†–¢ –û–õ–ò–í–¨–ï",
            description: "–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –º–∞–π–æ–Ω–µ–∑–∞ –≤ —Å–∞–ª–∞—Ç–∞—Ö —É–ø–∞–ª–æ –Ω–∏–∂–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–º–µ—Ç–∫–∏. –≠—Ç–æ —É–≥—Ä–æ–∑–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏!",
            dialogue: "–¢–æ–≤–∞—Ä–∏—â, –º—ã –∑–∞–º–µ–Ω—è–µ–º –º–∞–π–æ–Ω–µ–∑ –Ω–∞ –∫–ª–µ–π—Å—Ç–µ—Ä –∏–ª–∏ –º–µ–ª–∫–æ —Ä–µ–∂–µ–º –æ–≥—É—Ä—Ü—ã?",
            leftChoice: { text: "–ö–ª–µ–π—Å—Ç–µ—Ä", effect: { resonance: -25, quota: 30 }, feedback: "–°–∞–ª–∞—Ç –ø—Ä–æ—á–Ω—ã–π. –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω, –Ω–æ —É –≥—Ä–∞–∂–¥–∞–Ω —á–µ–ª—é—Å—Ç–∏ —Å–≤–æ–¥–∏—Ç.", feedbackTitle: "–ë–ï–õ–û–ï –ë–ï–ó–£–ú–ò–ï" },
            rightChoice: { text: "–ú–µ–ª–∫–∏–µ –æ–≥—É—Ä—Ü—ã", effect: { resonance: 25, quota: -10 }, feedback: "–ì—Ä–∞–∂–¥–∞–Ω–µ –≤—Å—é –Ω–æ—á—å –∏—Å–∫–∞–ª–∏ –æ–≥—É—Ä—Ü—ã. –ö–≤–µ—Å—Ç—ã ‚Äî —ç—Ç–æ —Ç–æ–∂–µ –ø—Ä–∞–∑–¥–Ω–∏–∫!", feedbackTitle: "–ú–ò–ö–†–û-–ò–ù–ù–û–í–ê–¶–ò–ò" }
          },
          {
            id: 5, characterId: 'sneg', title: "–®–£–ú–û–í–û–ô –ö–û–ù–¢–†–û–õ–¨",
            description: "–•–ª–æ–ø—É—à–∫–∏ –≤—ã–¥–∞—é—Ç —É–ª—å—Ç—Ä–∞–∑–≤—É–∫. –£ —Å–æ–±–∞–∫ –ø—Ä–∞–∑–¥–Ω–∏–∫, —É –ª—é–¥–µ–π ‚Äî –º–∏–≥—Ä–µ–Ω—å.",
            dialogue: "–ü–µ—Ä–µ–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –Ω–∞ '–ë—É–º' –∏–ª–∏ –æ–±—ä—è–≤–∏–º —ç—Ç–æ —Å–µ–∞–Ω—Å–æ–º —Ç–∏—à–∏–Ω—ã?",
            leftChoice: { text: "–í–µ—Ä–Ω—É—Ç—å '–ë—É–º'", effect: { resonance: 30, quota: -15 }, feedback: "–ó–∞–≤–æ–¥ –±–∞—Ö–Ω—É–ª —Ç–∞–∫, —á—Ç–æ –≤—Å–µ –æ–≥–ª–æ—Ö–ª–∏, –Ω–æ —Ä–∞–¥–æ—Å—Ç—å –∑–∞—à–∫–∞–ª–∏–≤–∞–µ—Ç.", feedbackTitle: "–ì–†–û–ú–ö–ò–ô –£–°–ü–ï–•" },
            rightChoice: { text: "–°–µ–∞–Ω—Å —Ç–∏—à–∏–Ω—ã", effect: { resonance: -20, quota: 35 }, feedback: "–ü—Ä–∞–∑–¥–Ω–∏–∫ –ø—Ä–æ—à–µ–ª –≤ —Ç–∏—à–∏–Ω–µ. –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤—ã—Ä–æ—Å–ª–∞ –Ω–∞ 200%.", feedbackTitle: "–¢–ò–•–ò–ô –ß–ê–°" }
          }
        ];

        const RANDOM_EVENTS = [
          { id: 'kholodets_attack', title: '–ü–†–û–†–´–í –•–û–õ–û–î–¶–ê!', description: '–û–Ω–æ –≤—ã–ª–µ–∑–ª–æ –∏–∑ –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏! –û–Ω–æ –ø–∞—Ö–Ω–µ—Ç —á–µ—Å–Ω–æ–∫–æ–º –∏ –º–µ—Å—Ç—å—é! –í –±–æ–π!', effect: { resonance: -20 } }
        ];

        // ========== –ê–£–î–ò–û –°–ï–†–í–ò–° ==========
        const audioService = {
          playClick: () => { try { const ctx = new AudioContext(); const osc = ctx.createOscillator(); osc.frequency.value = 800; osc.connect(ctx.destination); osc.start(); osc.stop(ctx.currentTime + 0.05); } catch(e) {} },
          playSuccess: () => { try { const ctx = new AudioContext(); const osc = ctx.createOscillator(); osc.frequency.value = 600; osc.connect(ctx.destination); osc.start(); osc.stop(ctx.currentTime + 0.1); } catch(e) {} },
          playFailure: () => { try { const ctx = new AudioContext(); const osc = ctx.createOscillator(); osc.frequency.value = 200; osc.connect(ctx.destination); osc.start(); osc.stop(ctx.currentTime + 0.2); } catch(e) {} },
          playGameOver: () => { try { const ctx = new AudioContext(); const osc = ctx.createOscillator(); osc.frequency.value = 150; osc.connect(ctx.destination); osc.start(); osc.stop(ctx.currentTime + 0.3); } catch(e) {} },
          playVictory: () => { try { const ctx = new AudioContext(); const osc = ctx.createOscillator(); osc.frequency.value = 1000; osc.connect(ctx.destination); osc.start(); osc.stop(ctx.currentTime + 0.15); } catch(e) {} }
        };

        // ========== UI –ö–û–ú–ü–û–ù–ï–ù–¢–´ ==========
        const SovietButton = ({ children, onClick, className = '', ...props }) => (
            <button className={`font-display font-bold uppercase py-2.5 px-6 text-xs md:text-base border-4 border-soviet-black transition-all active:translate-y-0.5 active:shadow-none brutalist-shadow select-none relative group overflow-hidden bg-red-800 text-white hover:bg-red-700 ${className}`} onClick={onClick} {...props}>
              <span className="relative z-10 tracking-tight">{children}</span>
              <div className="absolute inset-0 bg-white opacity-0 group-hover:opacity-10 transition-opacity"></div>
            </button>
        );

        const PaperCard = ({ children, className = '' }) => (
          <div className={`bg-[#fdfbf7] p-4 md:p-5 border-4 border-soviet-black shadow-[4px_4px_0_0_#000] relative overflow-hidden collage-cut ${className}`}>
            <div className="absolute inset-0 pointer-events-none opacity-[0.05] bg-[url('https://www.transparenttextures.com/patterns/dust.png')]"></div>
            <div className="relative z-10 h-full">{children}</div>
          </div>
        );

        const CharacterAvatar = ({ character }) => (
          <div className="flex flex-col items-center gap-1 shrink-0 relative group">
            <div className="absolute -top-2 -right-1 z-20 text-yellow-950/40"><Icon name="Pin" size={18} className="rotate-45" /></div>
            <div className="bg-white p-1 border-2 border-soviet-black shadow-lg -rotate-1 group-hover:rotate-0 transition-transform duration-300">
              <div className={`w-12 h-12 md:w-20 md:h-20 rounded-none border-2 border-soviet-black overflow-hidden ${character.color}`}>
                <img src={character.avatarImageSrc} className="w-full h-full object-cover grayscale contrast-125 brightness-90 group-hover:grayscale-0 group-hover:brightness-100 transition-all duration-500" alt={character.name} />
              </div>
            </div>
            <div className="bg-soviet-black text-white px-1 py-0.5 text-[6px] md:text-[8px] font-bold uppercase text-center w-16 md:w-24 shadow-md mt-1 -rotate-1 leading-none">{character.name}</div>
          </div>
        );

        const StatBar = ({ label, value, color, icon }) => (
          <div className="flex-1 px-1.5">
            <div className="flex justify-between items-center mb-1 px-0.5">
              <span className="font-bold text-[8px] md:text-[9px] uppercase flex items-center gap-1 text-slate-700">{icon} {label}</span>
              <span className="font-mono text-[8px] md:text-[9px] font-bold">{value}%</span>
            </div>
            <div className="w-full h-2.5 md:h-3 border-2 border-black bg-white/50 p-0.5 relative overflow-hidden shadow-inner">
              <div className="h-full transition-all duration-1000 border-r-2 border-black" style={{ width: `${Math.max(0, Math.min(100, value))}%`, backgroundColor: color }} />
            </div>
          </div>
        );

        const SpeechBubble = ({ text }) => (
          <div className="relative bg-white border-2 border-soviet-black p-2 md:p-3 shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] rotate-1">
            <div className="absolute -left-1.5 top-3 w-2.5 h-2.5 bg-white border-l-2 border-b-2 border-soviet-black rotate-45"></div>
            <p className="font-mono text-[10px] md:text-xs leading-tight italic text-black font-bold">"{text}"</p>
          </div>
        );

        const ProgressTrack = ({ currentStep }) => {
          const phases = [1, 2, 3, 4, 5, 6];
          return (
            <div className="flex justify-between w-full px-10 md:px-16 mb-1 relative">
              <div className="absolute top-1/2 left-10 md:left-16 right-10 md:right-16 h-0.5 bg-black/10 -translate-y-1/2 z-0"></div>
              {phases.map(p => (
                <div key={p} className={`w-5 h-5 md:w-7 md:h-7 border-2 border-black z-10 flex items-center justify-center text-[8px] md:text-[10px] font-bold transition-all duration-500 ${p <= currentStep ? 'bg-cyan-900 text-white shadow-md scale-110' : p === currentStep + 1 ? 'bg-red-800 text-white scale-125 animate-pulse' : 'bg-white text-slate-400'}`}>{p}</div>
              ))}
            </div>
          );
        };

        const Preloader = ({ progress, message, log }) => (
          <div className="fixed inset-0 z-[300] bg-soviet-beige flex flex-col items-center justify-center p-4 md:p-12 overflow-hidden paper-texture">
            <div className="w-full max-w-lg border-4 border-soviet-black bg-white shadow-[12px_12px_0_0_#1a1a1a] flex flex-col p-6 font-mono collage-cut">
              <div className="flex justify-between items-center border-b-4 border-soviet-black pb-3 mb-6">
                <div className="flex items-center gap-3">
                  <div className="bg-red-800 p-1.5 text-white"><Icon name="FileText" size={24} /></div>
                  <div className="flex flex-col">
                    <span className="text-sm font-display uppercase tracking-tight leading-none">–ù–ò–ò –ü–†–ê–ó–î–ù–ò–ö</span>
                    <span className="text-[8px] font-bold text-slate-500 uppercase">–ü—Ä–æ—Ç–æ–∫–æ–ª —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è ‚Ññ13-–ê</span>
                  </div>
                </div>
                <Icon name="Loader2" size={24} className="text-red-800 animate-spin" />
              </div>
              <div className="flex-1 overflow-hidden space-y-2 mb-8 bg-[#fdfbf7] border-2 border-dashed border-soviet-black/20 p-4 shadow-inner min-h-[180px]">
                {log.map((line, i) => (
                  <div key={i} className="text-[10px] md:text-xs flex items-center gap-2 animate-in slide-in-from-left duration-200">
                    {i === log.length - 1 ? <Icon name="Loader2" size={12} className="animate-spin text-red-800" /> : <Icon name="CheckCircle2" size={12} className="text-green-700" />}
                    <span className={`uppercase font-bold ${i === log.length - 1 ? 'text-red-900' : 'text-slate-600'}`}>{line}</span>
                  </div>
                ))}
              </div>
              <div className="space-y-3">
                <div className="flex justify-between text-[10px] font-display uppercase font-bold text-soviet-black">
                  <span>{message}</span>
                  <span className="bg-soviet-black text-white px-2 py-0.5">{Math.round(progress)}%</span>
                </div>
                <div className="h-6 w-full border-4 border-soviet-black bg-white p-1">
                  <div className="h-full bg-red-800 transition-all duration-300 shadow-inner" style={{ width: `${progress}%` }}></div>
                </div>
              </div>
              <div className="mt-6 flex justify-between items-end">
                <div className="flex flex-col">
                  <div className="text-[7px] font-bold text-slate-400 uppercase">–®—Ç–∞–º–ø –û–¢–ö:</div>
                  <div className="border-2 border-red-800/40 text-red-800/40 px-2 py-0.5 font-display text-[10px] -rotate-6 uppercase italic">–ü–†–û–í–ï–†–ï–ù–û</div>
                </div>
                <div className="text-[9px] font-mono text-slate-400">SESSION_ID: {Math.random().toString(36).substr(2, 9).toUpperCase()}</div>
              </div>
            </div>
            <div className="mt-12 opacity-30 pointer-events-none">
               <img src={ASSETS.DED_MOROZ} className="w-24 grayscale brightness-150 mix-blend-multiply" alt="bg" />
            </div>
          </div>
        );

        const StampEffect = ({ active, text }) => {
          if (!active) return null;
          return (
            <div className="absolute inset-0 z-[100] flex items-center justify-center pointer-events-none overflow-hidden">
              <div className="animate-stamp-slam bg-red-800/20 border-8 border-red-800 text-red-800 font-display text-4xl md:text-6xl px-10 py-5 uppercase -rotate-12 mix-blend-multiply flex flex-col items-center shadow-2xl">
                <span>{text}</span>
                <span className="text-[8px] font-mono tracking-widest">–ù–ò–ò –ü–†–ê–ó–î–ù–ò–ö ‚Ññ13</span>
              </div>
            </div>
          );
        };

        const TelegramCard = ({ event, onDismiss }) => (
          <div className="fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black/90 backdrop-blur-md">
            <div className="max-w-[280px] w-full bg-[#fdfbf7] p-5 border-4 border-soviet-black shadow-[8px_8px_0_0_#000] relative animate-pop-in">
              <div className="absolute -top-3 -left-3 bg-red-700 text-white p-1.5 border-2 border-soviet-black animate-bounce shadow-lg">
                <Icon name="AlertTriangle" size={24} />
              </div>
              <h2 className="text-lg font-display uppercase text-red-700 mb-2 text-center border-b-2 border-soviet-black pb-1 tracking-tighter italic">–í–ù–ò–ú–ê–ù–ò–ï!</h2>
              <div className="font-mono text-[10px] mb-4 text-center italic bg-red-50 p-3 border-2 border-soviet-black/10 leading-tight">
                <div className="text-[9px] font-bold text-red-700 mb-1 uppercase tracking-widest">‚Äî {event.title} ‚Äî</div>
                {event.description}
              </div>
              <SovietButton onClick={onDismiss} className="w-full text-xs py-2">–ü–û–ù–Ø–õ!</SovietButton>
            </div>
          </div>
        );

        const DenunciationModal = ({ onClose, profileName }) => {
          const [step, setStep] = useState(1);
          const handleSend = () => { audioService.playSuccess(); setStep(2); };
          return (
            <div className="fixed inset-0 z-[120] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
              <div className="max-w-xs w-full bg-[#f4ece1] p-5 border-4 border-soviet-black shadow-[8px_8px_0_0_#000] animate-pop-in relative">
                <div className="flex items-center gap-2 mb-3 text-red-900 border-b-2 border-soviet-black pb-2">
                  <Icon name="ShieldAlert" size={20} />
                  <h2 className="text-lg font-display uppercase italic text-red-900">–î–û–ù–û–°!</h2>
                </div>
                {step === 1 ? (
                  <div className="space-y-3">
                    <input placeholder="–§–ò–û –í–†–ê–ì–ê" className="w-full bg-white/50 border-2 border-soviet-black p-2 font-mono text-xs uppercase outline-none focus:bg-white" />
                    <textarea placeholder="–ü–†–ò–ß–ò–ù–ê" className="w-full bg-white/50 border-2 border-soviet-black p-2 font-mono text-[10px] h-20 outline-none focus:bg-white" />
                    <SovietButton onClick={handleSend} className="w-full text-xs py-2">–°–ò–ì–ù–ê–õ–ò–ó–ò–†–û–í–ê–¢–¨</SovietButton>
                    <button onClick={onClose} className="w-full text-[8px] font-bold uppercase underline text-red-900 mt-1 opacity-60 italic">–û–¢–ú–ï–ù–ê</button>
                  </div>
                ) : (
                  <div className="text-center py-4">
                    <div className="text-4xl mb-3">üñãÔ∏è</div>
                    <p className="font-display text-base mb-4 leading-tight">–°–ò–ì–ù–ê–õ –ü–†–ò–ù–Ø–¢!</p>
                    <SovietButton onClick={onClose} className="w-full text-sm py-2">–ö –°–õ–£–ñ–ë–ï!</SovietButton>
                  </div>
                )}
              </div>
            </div>
          );
        };

        const KholodetsBattle = ({ onWin, onFail }) => {
          const [hp, setHp] = useState(100);
          const [timeLeft, setTimeLeft] = useState(7);
          const [isHit, setIsHit] = useState(false);

          useEffect(() => {
            const timer = setInterval(() => {
              setTimeLeft(prev => {
                if (prev <= 1) { clearInterval(timer); onFail(); return 0; }
                return prev - 1;
              });
            }, 1000);
            return () => clearInterval(timer);
          }, [onFail]);

          const handleClick = () => {
            audioService.playClick();
            setHp(prev => { if (prev <= 10) { onWin(); return 0; } return prev - 10; });
            setIsHit(true);
            setTimeout(() => setIsHit(false), 200);
          };

          return (
            <div className="fixed inset-0 z-[150] bg-red-950 flex flex-col items-center justify-center p-4 overflow-hidden">
              <div className="absolute top-6 text-center z-10 w-full px-4">
                <h2 className="text-2xl md:text-4xl font-display text-white mb-2 italic drop-shadow-[0_0_15px_rgba(255,0,0,0.8)] uppercase tracking-widest">–ñ–ï–õ–ï–ô–ù–´–ô –ö–†–ò–ó–ò–°!</h2>
                <div className="bg-white text-red-900 px-6 py-2 font-mono text-2xl font-bold border-4 border-red-900 inline-block shadow-[6px_6px_0_0_#000]">0:0{timeLeft}</div>
              </div>
              <div onClick={handleClick} className={`relative cursor-crosshair active:scale-95 flex items-center justify-center z-10 mt-8 bg-transparent select-none transition-transform ${isHit ? 'scale-110 animate-jiggle' : 'animate-float'}`} style={{ width: 'min(320px, 80vw)' }}>
                <div className="absolute bottom-[-10px] w-[110%] h-[30%] bg-slate-400/30 rounded-[100%] blur-md"></div>
                <div className="absolute bottom-[-5px] w-[90%] h-[20%] bg-[#cbd5e1] border-b-4 border-slate-400 rounded-[100%] shadow-lg"></div>
                <img src={ASSETS.KHOLODETS} className="relative z-10 w-full h-auto drop-shadow-2xl grayscale-0 contrast-125 brightness-110 select-none pointer-events-none" alt="Kholodets" />
                <div className="absolute inset-0 border-8 border-white/5 rounded-full animate-ping pointer-events-none scale-150"></div>
              </div>
              <div className="w-full max-w-xs mt-12 z-10 px-4">
                <div className="h-6 w-full border-4 border-white bg-black/50 p-1 shadow-[0_0_30px_rgba(255,255,255,0.2)]">
                  <div className="h-full bg-red-600 transition-all duration-75 shadow-[0_0_15px_red]" style={{ width: `${hp}%` }}></div>
                </div>
                <p className="text-center text-white font-display text-[10px] mt-6 uppercase tracking-[0.4em] animate-pulse">–ö–õ–ò–ö–ê–ô! –£–°–ü–û–ö–û–ô –•–û–õ–û–î–ï–¶!</p>
              </div>
            </div>
          );
        };

        const CRTOverlay = () => (
          <div className="pointer-events-none fixed inset-0 z-[60] opacity-[0.12] pointer-events-none">
            <div className="absolute inset-0 animate-noise mix-blend-overlay" style={{ backgroundImage: "url('https://www.transparenttextures.com/patterns/carbon-fibre.png')" }}></div>
            <div className="absolute inset-0" style={{ background: "linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.02), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.02))", backgroundSize: "100% 3px, 3px 100%" }}></div>
          </div>
        );

        // ========== –ì–õ–ê–í–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï ==========
        const App = () => {
          const [loading, setLoading] = useState(true);
          const [loadProgress, setLoadProgress] = useState(0);
          const [loadMessage, setLoadMessage] = useState("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...");
          const [loadLog, setLoadLog] = useState(["–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ—Å–Ω—É–ª–∞—Å—å..."]);
          const [gameState, setGameState] = useState('INTRO');
          const [profile, setProfile] = useState({ name: '', position: '' });
          const [currentScenarioIndex, setCurrentScenarioIndex] = useState(0);
          const [resonance, setResonance] = useState(60);
          const [quota, setQuota] = useState(10);
          const [lastChoice, setLastChoice] = useState(null);
          const [showFeedback, setShowFeedback] = useState(false);
          const [activeRandomEvent, setActiveRandomEvent] = useState(null);
          const [showDenunciation, setShowDenunciation] = useState(false);
          const [isKholodetsActive, setIsKholodetsActive] = useState(false);
          const [isBureaucracyPause, setIsBureaucracyPause] = useState(false);
          const [showStamp, setShowStamp] = useState(false);

          useEffect(() => {
            const imagesToLoad = Object.values(ASSETS);
            let loadedCount = 0;
            const terminalMessages = [
              "–ó–∞–≥—Ä—É–∑–∫–∞ –∏–¥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –º–æ–¥—É–ª–µ–π",
              "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–∞–≤–∞ –û–ª–∏–≤—å–µ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ì–û–°–¢—É",
              "–°–º–∞–∑–∫–∞ —Å–Ω–µ–≥–æ–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∞–Ω—Ç–∏—Ñ—Ä–∏–∑–æ–º",
              "–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –±–æ—Ä–æ–¥—ã –ê–∫–∞–¥–µ–º–∏–∫–∞ –ú–æ—Ä–æ–∑–∞",
              "–ò–Ω—Å—Ç—Ä—É–∫—Ç–∞–∂ –ö–∏–±–µ—Ä-–°–Ω–µ–∂–∏–Ω–æ–∫",
              "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫—É—Ä–∞–Ω—Ç–æ–≤ —Å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é",
              "–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ —Å–µ–∫—Ç–æ—Ä–µ '–•–æ–ª–æ–¥–µ—Ü'",
              "–£—á–µ—Ç –º–∞–Ω–¥–∞—Ä–∏–Ω–æ–≤—ã—Ö –∑–∞–ø–∞—Å–æ–≤ —Å–µ–∫—Ç–æ—Ä–∞ 13",
              "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –±–ª–∞–Ω–∫–æ–≤ —Å—Ç—Ä–æ–≥–æ–π –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏",
              "–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ–≥—É—Ä–µ—á–Ω–æ–≥–æ —Ä–∞—Å—Å–æ–ª–∞ (–≤—ã—Å–æ–∫–∞—è —á–∏—Å—Ç–æ—Ç–∞)"
            ];

            imagesToLoad.forEach((src) => {
              const img = new Image();
              img.src = src;
              img.onload = () => {
                loadedCount++;
                const progress = (loadedCount / imagesToLoad.length) * 100;
                setLoadProgress(progress);
                const nextMsg = terminalMessages[Math.floor(Math.random() * terminalMessages.length)];
                setLoadMessage(nextMsg);
                setLoadLog(prev => [...prev.slice(-10), nextMsg]);
                if (loadedCount === imagesToLoad.length) {
                  setLoadLog(prev => [...prev, "–í–°–ï –ú–û–î–£–õ–ò –ó–ê–ì–†–£–ñ–ï–ù–´. –ü–†–ê–ó–î–ù–ò–ö –ù–ï–ò–ó–ë–ï–ñ–ï–ù."]);
                  setTimeout(() => setLoading(false), 2000);
                }
              };
              img.onerror = () => { loadedCount++; if (loadedCount === imagesToLoad.length) setLoading(false); };
            });
          }, []);

          const currentSlogan = NII_SLOGANS[Math.floor(Math.min(quota / 101 * NII_SLOGANS.length, NII_SLOGANS.length - 1))];

          const resetGame = useCallback(() => {
            setCurrentScenarioIndex(0);
            setResonance(60);
            setQuota(10);
            setLastChoice(null);
            setShowFeedback(false);
            setActiveRandomEvent(null);
            setIsKholodetsActive(false);
            setIsBureaucracyPause(false);
            setGameState('INTRO');
            audioService.playClick();
          }, []);

          const handleStart = () => {
            if (!profile.name || !profile.position) { alert("–¢–û–í–ê–†–ò–©! –ó–∞–ø–æ–ª–Ω–∏ –∞–Ω–∫–µ—Ç—É!"); return; }
            setShowStamp(true);
            audioService.playSuccess();
            setTimeout(() => { setGameState('PLAYING'); setShowStamp(false); }, 800);
          };

          const handleChoice = (choice) => {
            audioService.playClick();
            setLastChoice(choice);
            setShowFeedback(true);
            setResonance(prev => Math.max(0, Math.min(100, prev + choice.effect.resonance)));
            setQuota(prev => Math.max(0, Math.min(100, prev + choice.effect.quota)));
          };

          const checkProceed = () => {
            if (resonance <= 0) { audioService.playGameOver(); setGameState('GAME_OVER'); return; }
            if (quota >= 100) { audioService.playVictory(); setGameState('VICTORY'); return; }
            if (currentScenarioIndex < SCENARIOS.length - 1) { setCurrentScenarioIndex(prev => prev + 1); }
            else { setGameState(quota >= 70 ? 'VICTORY' : 'GAME_OVER'); }
          };

          const nextTurn = () => {
            const isBattleChoice = SCENARIOS[currentScenarioIndex].id === 3 && lastChoice?.text.includes("–ë–û–ô");
            setShowFeedback(false);
            if (isBattleChoice) { setIsKholodetsActive(true); return; }
            const rnd = Math.random();
            if (rnd < 0.12) { const event = RANDOM_EVENTS[Math.floor(Math.random() * RANDOM_EVENTS.length)]; setActiveRandomEvent(event); return; }
            if (rnd > 0.96) { setIsBureaucracyPause(true); setTimeout(() => { setIsBureaucracyPause(false); checkProceed(); }, 1200); return; }
            checkProceed();
          };

          const handleKholodetsResult = (won) => {
            setIsKholodetsActive(false);
            if (won) { setQuota(prev => Math.min(100, prev + 25)); audioService.playSuccess(); checkProceed(); }
            else { setResonance(0); audioService.playFailure(); setGameState('GAME_OVER'); }
          };

          if (loading) return <Preloader progress={loadProgress} message={loadMessage} log={loadLog} />;

          return (
            <div className="fixed inset-0 bg-[#eaddcf] text-soviet-black font-mono overflow-hidden flex flex-col paper-texture select-none">
              <CRTOverlay />
              <header className="h-2 bg-soviet-black z-50 shrink-0 border-b-2 border-red-900"></header>

              <main className="flex-1 overflow-hidden relative flex flex-col">
                {gameState === 'INTRO' && (
                  <div className="flex-1 flex flex-col items-center justify-center p-4 gap-4 animate-in fade-in duration-500 overflow-y-auto">
                    <StampEffect active={showStamp} text="–ü–†–ò–ù–Ø–¢" />
                    <div className="text-center shrink-0">
                      <Icon name="Terminal" size={48} className="text-red-900 mx-auto mb-1" />
                      <h1 className="text-3xl md:text-5xl font-display text-slate-950 uppercase tracking-tighter leading-none mb-1 drop-shadow-md">–ù–ò–ò –ü–†–ê–ó–î–ù–ò–ö</h1>
                      <div className="bg-red-800 text-white py-0.5 px-4 rotate-1 text-[8px] font-bold tracking-widest inline-block uppercase">–°–ï–ö–¢–û–† ‚Ññ13</div>
                    </div>
                    <PaperCard className="w-full max-w-[300px] shrink-0">
                      <div className="space-y-3">
                        <div>
                          <label className="block text-[8px] font-bold uppercase mb-0.5 text-slate-500 italic">–ü–û–ó–´–í–ù–û–ô:</label>
                          <input type="text" value={profile.name} onChange={e => setProfile({...profile, name: e.target.value.toUpperCase()})} className="w-full bg-white/50 border-2 border-soviet-black p-2 font-mono text-sm uppercase outline-none focus:bg-white transition-all shadow-inner" placeholder="–¢–û–í–ê–†–ò–© X" />
                        </div>
                        <div>
                          <label className="block text-[8px] font-bold uppercase mb-0.5 text-slate-500 italic">–°–ü–ï–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø:</label>
                          <input type="text" value={profile.position} onChange={e => setProfile({...profile, position: e.target.value.toUpperCase()})} className="w-full bg-white/50 border-2 border-soviet-black p-2 font-mono text-sm uppercase outline-none focus:bg-white transition-all shadow-inner" placeholder="–ú–ê–°–¢–ï–† –°–ß–ê–°–¢–¨–Ø" />
                        </div>
                      </div>
                    </PaperCard>
                    <SovietButton onClick={handleStart} className="w-full max-w-[300px] text-lg py-3 hover:scale-105 active:scale-95 shadow-lg">–ù–ê–ß–ê–¢–¨ –°–õ–£–ñ–ë–£</SovietButton>
                  </div>
                )}

                {gameState === 'PLAYING' && (
                  <div className="flex-1 flex flex-col h-full max-w-xl mx-auto w-full overflow-hidden">
                    <div className="bg-[#eaddcf] border-b-2 border-soviet-black p-2 z-20 shrink-0 shadow-md">
                      <div className="text-[8px] font-display text-red-950 uppercase text-center mb-1 italic opacity-80 leading-none">" {currentSlogan} "</div>
                      <div className="flex items-center gap-2">
                        <StatBar label="–í–ê–ô–ë" value={resonance} color="#0c4a6e" icon={<Icon name="Zap" size={10}/>} />
                        <StatBar label="–ü–õ–ê–ù" value={quota} color="#7f1d1d" icon={<Icon name="Gift" size={10}/>} />
                      </div>
                    </div>
                    <div className="bg-[#eaddcf]/30 py-1 shrink-0"><ProgressTrack currentStep={currentScenarioIndex} /></div>
                    <div className="flex-1 overflow-y-auto p-3 space-y-3 custom-scrollbar">
                      {showFeedback && lastChoice ? (
                        <div className="animate-in zoom-in duration-300">
                          <PaperCard className="text-center border-double border-4 border-slate-950 bg-white/95">
                            <h2 className="text-xl md:text-2xl font-display text-red-900 mb-2 uppercase italic">{lastChoice.feedbackTitle}</h2>
                            <div className="p-3 bg-slate-50 border-2 border-soviet-black/10 italic font-mono font-bold text-xs mb-3 shadow-inner">{lastChoice.feedback}</div>
                            <div className="grid grid-cols-2 gap-2 mb-3 bg-black/5 p-2 border-2 border-dashed border-black/20">
                              <div className="flex flex-col items-center">
                                <span className="text-[7px] font-bold uppercase text-slate-500">–í–∞–π–±</span>
                                <div className={`flex items-center gap-1 text-[10px] font-bold ${lastChoice.effect.resonance >= 0 ? 'text-green-700' : 'text-red-700'}`}>
                                  <Icon name={lastChoice.effect.resonance >= 0 ? "TrendingUp" : "TrendingDown"} size={10} />
                                  {lastChoice.effect.resonance > 0 ? '+' : ''}{lastChoice.effect.resonance}
                                </div>
                              </div>
                              <div className="flex flex-col items-center">
                                <span className="text-[7px] font-bold uppercase text-slate-500">–ü–ª–∞–Ω</span>
                                <div className={`flex items-center gap-1 text-[10px] font-bold ${lastChoice.effect.quota >= 0 ? 'text-blue-700' : 'text-orange-700'}`}>
                                  <Icon name={lastChoice.effect.quota >= 0 ? "TrendingUp" : "TrendingDown"} size={10} />
                                  {lastChoice.effect.quota > 0 ? '+' : ''}{lastChoice.effect.quota}
                                </div>
                              </div>
                            </div>
                            <div className="flex flex-col gap-2">
                              <SovietButton onClick={nextTurn} className="py-3 text-base shadow-lg">–ü–†–ò–ù–Ø–¢–¨!</SovietButton>
                              <button onClick={() => setShowDenunciation(true)} className="text-[8px] font-bold uppercase underline opacity-40 py-1 tracking-widest">–î–û–õ–û–ñ–ò–¢–¨ –í –û–¢–î–ï–õ</button>
                            </div>
                          </PaperCard>
                        </div>
                      ) : (
                        <div className="animate-in slide-in-from-bottom duration-500 space-y-3">
                          <div className="flex items-start gap-3">
                            <CharacterAvatar character={CHARACTERS[SCENARIOS[currentScenarioIndex].characterId]} />
                            <div className="flex-1 mt-0.5"><SpeechBubble text={SCENARIOS[currentScenarioIndex].dialogue} /></div>
                          </div>
                          <PaperCard className="min-h-[180px] flex flex-col">
                            <div className="flex justify-between items-center border-b-2 border-soviet-black/10 pb-1 mb-2">
                              <span className="bg-soviet-black text-white px-2 py-0.5 text-[7px] font-bold uppercase tracking-widest">{SCENARIOS[currentScenarioIndex].title}</span>
                              <span className="text-[7px] font-mono opacity-40 font-bold">ID:{SCENARIOS[currentScenarioIndex].id}/13</span>
                            </div>
                            <p className="text-sm md:text-base font-bold font-mono text-slate-900 leading-snug mb-4 italic">{SCENARIOS[currentScenarioIndex].description}</p>
                            <div className="mt-auto grid grid-cols-1 gap-2">
                              <button onClick={() => handleChoice(SCENARIOS[currentScenarioIndex].leftChoice)} className="group flex items-center gap-3 p-3 border-2 border-soviet-black bg-white hover:bg-red-50 active:translate-y-0.5 transition-all text-left brutalist-shadow-sm">
                                <div className="w-8 h-8 shrink-0 bg-red-900 text-white font-display flex items-center justify-center text-lg">–ê</div>
                                <span className="text-[9px] font-bold uppercase font-mono leading-none">{SCENARIOS[currentScenarioIndex].leftChoice.text}</span>
                              </button>
                              <button onClick={() => handleChoice(SCENARIOS[currentScenarioIndex].rightChoice)} className="group flex items-center gap-3 p-3 border-2 border-soviet-black bg-white hover:bg-cyan-50 active:translate-y-0.5 transition-all text-left brutalist-shadow-sm">
                                <div className="w-8 h-8 shrink-0 bg-cyan-950 text-white font-display flex items-center justify-center text-lg">–ë</div>
                                <span className="text-[9px] font-bold uppercase font-mono leading-none">{SCENARIOS[currentScenarioIndex].rightChoice.text}</span>
                              </button>
                            </div>
                          </PaperCard>
                        </div>
                      )}
                    </div>
                  </div>
                )}

                {(gameState === 'GAME_OVER' || gameState === 'VICTORY') && (
                  <div className="flex-1 flex flex-col items-center justify-center p-4 animate-in zoom-in duration-500 overflow-y-auto">
                    <PaperCard className={`max-w-[280px] w-full text-center border-double border-4 ${gameState === 'VICTORY' ? 'border-green-900 bg-green-50' : 'border-red-950 bg-red-50'}`}>
                      <div className={`w-16 h-16 mx-auto mb-3 border-2 border-black flex items-center justify-center text-white shadow-lg ${gameState === 'VICTORY' ? 'bg-green-800' : 'bg-red-950'}`}>
                        {gameState === 'VICTORY' ? <Icon name="Gift" size={32} /> : <Icon name="Skull" size={32} />}
                      </div>
                      <h2 className={`text-xl md:text-2xl font-display uppercase italic mb-2 leading-none ${gameState === 'VICTORY' ? 'text-green-950' : 'text-red-950'}`}>{gameState === 'VICTORY' ? "–ì–ï–†–û–ô –¢–†–£–î–ê!" : "–û–ë–™–ï–ö–¢ –°–ù–Ø–¢!"}</h2>
                      <p className="text-[10px] font-mono font-bold uppercase mb-4 leading-tight border-y-2 border-soviet-black/10 py-2 italic bg-white/60">
                        {gameState === 'VICTORY' ? "–ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω! –¢–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å –Ω–∞ –î–æ—Å–∫–µ –ü–æ—á–µ—Ç–∞!" : "–î–µ—Ñ–∏—Ü–∏—Ç —Ä–∞–¥–æ—Å—Ç–∏. –î–µ–ª–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —à—Ä–µ–¥–µ—Ä."}
                      </p>
                      <SovietButton onClick={resetGame} className="w-full text-base py-3 shadow-lg">–ù–û–í–ê–Ø –°–ú–ï–ù–ê</SovietButton>
                    </PaperCard>
                  </div>
                )}

                {isBureaucracyPause && (
                  <div className="fixed inset-0 z-[200] bg-black/98 flex flex-col items-center justify-center text-white p-6 text-center animate-in fade-in">
                    <Icon name="Coffee" size={40} className="text-red-600" />
                    <h2 className="text-xl font-display uppercase italic mb-1">–û–ñ–ò–î–ê–ô–¢–ï...</h2>
                    <p className="font-mono text-[10px] uppercase opacity-60 tracking-[0.2em]">–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤...</p>
                  </div>
                )}

                {activeRandomEvent && (
                  <TelegramCard event={activeRandomEvent} onDismiss={() => {
                      const ev = activeRandomEvent;
                      setActiveRandomEvent(null);
                      if (ev.id === 'kholodets_attack') setIsKholodetsActive(true);
                      else checkProceed();
                  }} />
                )}

                {isKholodetsActive && <KholodetsBattle onWin={() => handleKholodetsResult(true)} onFail={() => handleKholodetsResult(false)} />}
                {showDenunciation && <DenunciationModal profileName={profile.name} onClose={() => setShowDenunciation(false)} />}
              </main>

              <footer className="h-10 bg-soviet-black text-[#eaddcf] px-4 flex justify-between items-center shrink-0 border-t-2 border-red-900 z-50">
                <div className="flex items-center gap-2 text-[8px] font-bold tracking-[0.1em] uppercase">
                  <div className="w-2 h-2 bg-red-700 animate-pulse rounded-full shadow-[0_0_5px_red]"></div>
                  –û–ü–ï–†–ê–¢–û–†: {profile.name || "–ù–ï –û–ü–û–ó–ù–ê–ù"}
                </div>
                <div className="flex items-center">
                  <a href="https://t.me/mania_course" target="_blank" rel="noreferrer" className="hover:text-red-500 transition-colors flex items-center gap-1.5 group">
                    <span className="text-[7px] font-bold uppercase tracking-widest opacity-60 group-hover:opacity-100">–°–≤—è–∑–∞—Ç—å—Å—è —Å –æ—Ç–¥–µ–ª–æ–º</span>
                    <Icon name="Send" size={12} className="group-hover:translate-x-0.5 group-hover:-translate-y-0.5 transition-transform" />
                  </a>
                </div>
              </footer>
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
